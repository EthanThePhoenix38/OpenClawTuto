# =============================================================================
# OpenClaw Environment Configuration ‚Äî Ultra-Secure
# Version: 2.0.0
# Auteur: Ethan Bernier (ORCID: 0009-0008-9839-5763)
# Date: 2026-02-13
# =============================================================================
#
# USAGE :
#   cp .env.example .env
#   # Choisir un DEPLOY_MODE puis remplir les valeurs
#
# MODES DE D√âPLOIEMENT :
#   local   ‚Üí Docker Compose simple (dev/home lab, pas de proxy)
#   k3d     ‚Üí Docker Compose + Squid proxy + monitoring (isol√©, Zero-Trust)
#   koyeb   ‚Üí Cloud Koyeb (pas d'acc√®s LLM local, API keys obligatoires)
#
# S√âCURIT√â :
#   - Conforme aux recommandations post-CVE-2026-25253
#   - Tokens d'authentification obligatoires
#   - mDNS d√©sactiv√© en production
#   - Sandbox scope per-agent
#   - Control UI s√©curis√©
#
# =============================================================================

# -----------------------------------------------------------------------------
# üìå MODE DE D√âPLOIEMENT (OBLIGATOIRE)
# -----------------------------------------------------------------------------
# Valeurs : local | k3d | koyeb
DEPLOY_MODE=local

# -----------------------------------------------------------------------------
# üîê S√âCURIT√â GATEWAY (CRITIQUE ‚Äî CVE-2026-25253)
# -----------------------------------------------------------------------------
# Mode d'authentification: "token" (recommand√©) ou "password"
# ‚ö†Ô∏è  NE JAMAIS utiliser "none" en production !
OPENCLAW_AUTH_MODE=token

# Token d'authentification gateway ‚Äî CHANGEZ-LE !
# G√©n√©rer un token : openssl rand -hex 32
OPENCLAW_GATEWAY_TOKEN=CHANGEZ_MOI_openssl_rand_hex_32

# Politique DM : "pairing" (couplage s√©curis√©) ou "allowlist"
# ‚ö†Ô∏è  NE JAMAIS utiliser "open" en production !
OPENCLAW_DM_ACCESS=pairing

# D√©sactiver la d√©couverte mDNS en production
OPENCLAW_MDNS_MODE=off

# Interdire l'auth non s√©curis√©e sur le Control UI
OPENCLAW_CONTROL_UI_INSECURE_AUTH=false

# Sandbox scope : "agent" (d√©faut, recommand√©) ou "session" (plus strict)
OPENCLAW_SANDBOX_SCOPE=agent

# Mode sandbox : "non-main" emp√™che l'ex√©cution sur le thread principal
OPENCLAW_SANDBOX_MODE=non-main

# -----------------------------------------------------------------------------
# üñ•Ô∏è CONFIGURATION SERVEUR
# -----------------------------------------------------------------------------
NODE_ENV=production
OPENCLAW_PORT=18789

# ‚ö†Ô∏è  BIND ADDRESS :
#   - local/k3d : 127.0.0.1 (JAMAIS 0.0.0.0 sauf derri√®re reverse proxy)
#   - koyeb     : 0.0.0.0 (requis par le PaaS, s√©curis√© par la plateforme)
OPENCLAW_HOST=127.0.0.1

# Niveau de log : debug | info | warn | error
OPENCLAW_LOG_LEVEL=info

# Timezone
TZ=Europe/Paris

# -----------------------------------------------------------------------------
# üîë API KEYS (stockez en secrets, pas en clair !)
# -----------------------------------------------------------------------------
# En local/k3d  : optionnel si vous utilisez Ollama/LM Studio
# En koyeb      : AU MOINS UNE cl√© obligatoire
#
# Anthropic : https://console.anthropic.com/
ANTHROPIC_API_KEY=

# OpenAI : https://platform.openai.com/api-keys
OPENAI_API_KEY=

# Google AI (Gemini) : https://aistudio.google.com/apikey
GOOGLE_AI_API_KEY=

# Mistral AI : https://console.mistral.ai/api-keys
MISTRAL_API_KEY=

# -----------------------------------------------------------------------------
# ü§ñ LLM LOCAUX (local & k3d uniquement)
# -----------------------------------------------------------------------------
# Ollama (doit tourner en natif sur le host)
OLLAMA_HOST=http://host.docker.internal:11434

# LM Studio
LM_STUDIO_HOST=http://host.docker.internal:1234

# -----------------------------------------------------------------------------
# üõ°Ô∏è PROXY SQUID (k3d uniquement)
# -----------------------------------------------------------------------------
# En mode k3d, tout le trafic sortant passe par Squid (whitelist stricte)
# En mode local, le proxy est d√©sactiv√© (comment√© dans docker-compose)
# En mode koyeb, le proxy n'est pas d√©ploy√©
HTTP_PROXY=http://squid:3128
HTTPS_PROXY=http://squid:3128
NO_PROXY=localhost,127.0.0.1,host.docker.internal,ollama,openclaw

# -----------------------------------------------------------------------------
# üìä MONITORING (k3d uniquement, optionnel)
# -----------------------------------------------------------------------------
# Mot de passe admin Grafana ‚Äî CHANGEZ-LE !
GRAFANA_PASSWORD=CHANGEZ_MOI

# R√©tention Prometheus (jours)
PROMETHEUS_RETENTION_DAYS=7

# -----------------------------------------------------------------------------
# üê≥ RESSOURCES DOCKER
# -----------------------------------------------------------------------------
# Limites CPU/M√©moire pour OpenClaw
OPENCLAW_CPU_LIMIT=2
OPENCLAW_MEM_LIMIT=2G
OPENCLAW_CPU_RESERVATION=0.5
OPENCLAW_MEM_RESERVATION=512M

# Limites pour Squid (k3d)
SQUID_CPU_LIMIT=0.5
SQUID_MEM_LIMIT=512M

# PID limit (protection fork bomb)
OPENCLAW_PIDS_LIMIT=256

# Taille tmpfs pour /tmp
OPENCLAW_TMPFS_SIZE=1073741824

# =============================================================================
# üö® CHECKLIST S√âCURIT√â AVANT D√âPLOIEMENT
# =============================================================================
#
# [ ] OPENCLAW_GATEWAY_TOKEN chang√© (pas la valeur par d√©faut)
# [ ] OPENCLAW_AUTH_MODE = token (jamais "none")
# [ ] OPENCLAW_DM_ACCESS = pairing (jamais "open")
# [ ] OPENCLAW_HOST = 127.0.0.1 (sauf koyeb)
# [ ] GRAFANA_PASSWORD chang√©
# [ ] API keys stock√©es de mani√®re s√©curis√©e
# [ ] Image OpenClaw >= 2026.1.29 (post-CVE-2026-25253)
# [ ] Pas de skills non v√©rifi√©s install√©s
# [ ] Audit de s√©curit√© : openclaw security audit --deep
# [ ] Tokens et credentials rot√©s r√©guli√®rement
#
# =============================================================================
